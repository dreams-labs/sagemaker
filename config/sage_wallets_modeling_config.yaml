#SageMaker Modeling Config
framework:
    name: xgboost
    version: 1.7-1

metaparams:
    endpoint_preds_dir: temp/endpoint_predictions
    instance_type: ml.m6i.2xlarge
    # instance_type: ml.c5.9xlarge
    # instance_type: ml.c6i.4xlarge
    instance_count: 1
    batch_trans_instance_type: ml.c5.2xlarge
    batch_trans_instance_count: 1

script_mode:
    enabled: True
    entry_point: single_model_entry.py
    # entry_point: temporal_cv_model_entry.py
    source_dir: ../src/script_modeling

# KeyParam Target Var
target:
    classification:
        threshold: 0.40  # if target > {threshold}, class = 1
    custom_transform: True
    target_var: crypto_net_gain/crypto_inflows/base
    custom_val:
        metric: cw_coin_return
        method: top_percentile # top_percentile of top_scores
        top_percentile: 0.05  # percent to apply validation
        top_scores: 0.8  # scores above this are validated

training:
    model_type: classification  # regression or classification
    eval_metric: aucpr

    #KeyParam Hyperparameters
    hyperparameters:

        # trees
        num_round: 500
        max_depth: 3
        min_child_weight: 13
        eta: 0.5
        early_stopping_rounds: 25

        # sampling
        subsample: 0.8
        colsample_bytree: 0.8
        scale_pos_weight: 5  # 1 to disable

        # feature selection
        alpha: 0.75   # 0 to disable
        lambda: 1.50  # 1 to disable

    # KeyParam HPO Tuning
    hpo:  # Hyperparameter Optimization
        # enabled: True
        objective_metric_name: validation:aucpr
        objective_type: maximize
        param_ranges:
        # Allowed values in the built in mode: [colsample_bytree, num_parallel_tree, max_depth, colsample_bynode, lambda, eta, alpha, num_round, colsample_bylevel, subsample, min_child_weight, max_delta_step, gamma]
            max_depth:  [2, 8]
            min_child_weight:  [5, 500]
            # eta:        [0.05, 0.2]
            # subsample: [0.6, 1.0]
            # colsample_bytree: [0.6, 1.0]
            # alpha:  [0, 10]
            # lambda: [1, 20]  # needs 'reg_' to escape reserved keyword
            # gamma: [0, 5]
            scale_pos_weight: [1, 100]
        max_jobs: 40
        max_parallel_jobs: 10

predicting:
    y_pred_threshold: 0.8 # predictions above this are positive